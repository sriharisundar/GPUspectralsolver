<html>
<head>
<title>Matrix and Vec</title>
</head>
<body>
<h1><code>Matrix and Vec</code></h1>

<p>Download: <a href="matrix_C.zip">matrix.zip</a>.

<p>See: <a href="#matrix.h">matrix.h</a>,&nbsp;&nbsp;
<a href="#matrix.cpp">matrix.cpp</a>,&nbsp;&nbsp;
<a href="#main.cpp">main.cpp</a> (small test program)

<p>The <a href="#Matrix"><code>Matrix</code></a> class is a matrix data structure and routines for
matrix manuipulation. The class <a href="#Vec"><code>Vec</code></a> is a simple column
(or row) vector.


<h2><code>matrix.h</code></h2>

<p><hr><a name=matrix.h>
<!-- Generator: GNU source-highlight 2.1.2
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><i><font color="#9A1900">/*</font></i><i><font color="#9A1900">\file matrix.h</font></i>
<i><font color="#9A1900">*</font></i>
<i><font color="#9A1900">*    matrix data structure, and routines for matrix manipulation.</font></i>
<i><font color="#9A1900">*/</font></i>
<b><font color="#000080">#if</font></b> <font color="#990000">!</font><b><font color="#000000">defined</font></b><font color="#990000">(</font>__MATRIX_H<font color="#990000">)</font>
<b><font color="#000080">#define</font></b> __MATRIX_H
<b><font color="#000080">#include</font></b> <font color="#FF0000">&lt;string&gt;</font>
<b><font color="#000080">#include</font></b> <font color="#FF0000">&lt;assert.h&gt;</font>

<i><font color="#9A1900">//</font></i><i><font color="#9A1900"> \typedef</font></i>
<i><font color="#9A1900">//</font></i><i><font color="#9A1900">! pointer to a function which returns a double and takes as argument a double</font></i>
<b><font color="#0000FF">typedef</font></b> <font color="#009900">double</font> <font color="#990000">(</font><font color="#990000">*</font>V_FCT_PTR<font color="#990000">)</font><font color="#990000">(</font><font color="#009900">double</font><font color="#990000">)</font><font color="#990000">;</font>
<a name=Vec>
<i><font color="#9A1900">//</font></i><i><font color="#9A1900">! defines a vector of doubles</font></i>
<b><font color="#0000FF">class</font></b> Vec <font color="#FF0000">{</font>
<b><font color="#0000FF">public</font></b><font color="#990000">:</font>
	
	<b><font color="#000000">Vec</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">:</font> <b><font color="#000000">n</font></b><font color="#990000">(</font><font color="#993399">0</font><font color="#990000">)</font><font color="#990000">,</font> <b><font color="#000000">body</font></b><font color="#990000">(</font><font color="#993399">0</font><font color="#990000">)</font> <font color="#FF0000">{</font> <font color="#FF0000">}</font> <i><font color="#9A1900">//</font></i><i><font color="#9A1900">!&lt; default no-argument constructor</font></i>
	<i><font color="#9A1900">//</font></i><i><font color="#9A1900">! constructs a vector of length n</font></i>
	<b><font color="#000000">Vec</font></b><font color="#990000">(</font><font color="#009900">int</font> size<font color="#990000">)</font><font color="#990000">:</font> <b><font color="#000000">n</font></b><font color="#990000">(</font><font color="#993399">0</font><font color="#990000">)</font><font color="#990000">,</font> <b><font color="#000000">body</font></b><font color="#990000">(</font><font color="#993399">0</font><font color="#990000">)</font> <font color="#FF0000">{</font> <b><font color="#000000">create</font></b><font color="#990000">(</font>size<font color="#990000">)</font><font color="#990000">;</font> <font color="#FF0000">}</font>
	<b><font color="#000000">Vec</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> Vec <font color="#990000">&amp;</font>src<font color="#990000">)</font><font color="#990000">:</font> <b><font color="#000000">n</font></b><font color="#990000">(</font><font color="#993399">0</font><font color="#990000">)</font><font color="#990000">,</font> <b><font color="#000000">body</font></b><font color="#990000">(</font><font color="#993399">0</font><font color="#990000">)</font> <font color="#FF0000">{</font> <b><font color="#000000">copy</font></b><font color="#990000">(</font>src<font color="#990000">)</font><font color="#990000">;</font> <font color="#FF0000">}</font> <i><font color="#9A1900">//</font></i><i><font color="#9A1900">!&lt; copy constructor</font></i>
	<font color="#990000">~</font><b><font color="#000000">Vec</font></b><font color="#990000">(</font><font color="#990000">)</font> <font color="#FF0000">{</font> <b><font color="#0000FF">delete</font></b> <font color="#990000">[</font><font color="#990000">]</font> body<font color="#990000">;</font> body<font color="#990000">=</font><font color="#993399">0</font><font color="#990000">;</font> n<font color="#990000">=</font><font color="#993399">0</font><font color="#990000">;</font> <font color="#FF0000">}</font> <i><font color="#9A1900">//</font></i><i><font color="#9A1900">!&lt; destructor</font></i>
	<i><font color="#9A1900">//</font></i><i><font color="#9A1900">! creates (or resets) vector length and allocated space</font></i>
	<font color="#009900">void</font> <b><font color="#000000">create</font></b><font color="#990000">(</font><font color="#009900">int</font> size<font color="#990000">)</font><font color="#990000">;</font>
	<i><font color="#9A1900">//</font></i><i><font color="#9A1900">! returns the length (number of elements) of the vector</font></i>
	<font color="#009900">int</font> <b><font color="#000000">length</font></b><font color="#990000">(</font><font color="#990000">)</font> <b><font color="#0000FF">const</font></b> <font color="#FF0000">{</font> <b><font color="#0000FF">return</font></b> n<font color="#990000">;</font> <font color="#FF0000">}</font>
	<i><font color="#9A1900">//</font></i><i><font color="#9A1900">! prints vector contents to stdout</font></i>
	<font color="#009900">void</font> <b><font color="#000000">print</font></b><font color="#990000">(</font><font color="#990000">)</font> <b><font color="#0000FF">const</font></b><font color="#990000">;</font>
	<i><font color="#9A1900">//</font></i><i><font color="#9A1900">! set to constant value</font></i>
	Vec <font color="#990000">&amp;</font><b><font color="#000000">set</font></b><font color="#990000">(</font><font color="#009900">double</font> v<font color="#990000">)</font> <font color="#FF0000">{</font> <b><font color="#0000FF">for</font></b> <font color="#990000">(</font><font color="#009900">int</font> i<font color="#990000">=</font><font color="#993399">0</font><font color="#990000">;</font> i<font color="#990000">&lt;</font><b><font color="#000000">length</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">;</font> i<font color="#990000">+</font><font color="#990000">+</font><font color="#990000">)</font> body<font color="#990000">[</font>i<font color="#990000">]</font> <font color="#990000">=</font> v<font color="#990000">;</font> <b><font color="#0000FF">return</font></b> <font color="#990000">*</font><b><font color="#0000FF">this</font></b><font color="#990000">;</font> <font color="#FF0000">}</font>
	<i><font color="#9A1900">//</font></i><i><font color="#9A1900">! subscript operator (non-const object)</font></i>
	<font color="#009900">double</font> <font color="#990000">&amp;</font><b><font color="#0000FF">operator</font></b><font color="#990000">[</font><font color="#990000">]</font><font color="#990000">(</font><font color="#009900">int</font> n<font color="#990000">)</font> <font color="#FF0000">{</font><b><font color="#0000FF">return</font></b> body<font color="#990000">[</font>n<font color="#990000">]</font><font color="#990000">;</font> <font color="#FF0000">}</font>
	<i><font color="#9A1900">//</font></i><i><font color="#9A1900">! subscript operator (const object)</font></i>
	<b><font color="#0000FF">const</font></b> <font color="#009900">double</font> <font color="#990000">&amp;</font><b><font color="#0000FF">operator</font></b><font color="#990000">[</font><font color="#990000">]</font><font color="#990000">(</font><font color="#009900">int</font> n<font color="#990000">)</font> <b><font color="#0000FF">const</font></b> <font color="#FF0000">{</font> <b><font color="#0000FF">return</font></b> body<font color="#990000">[</font>n<font color="#990000">]</font><font color="#990000">;</font> <font color="#FF0000">}</font>
	Vec <font color="#990000">&amp;</font><b><font color="#0000FF">operator</font></b><font color="#990000">=</font><font color="#990000">(</font><b><font color="#0000FF">const</font></b> Vec <font color="#990000">&amp;</font>src<font color="#990000">)</font> <font color="#FF0000">{</font> <b><font color="#0000FF">return</font></b> <font color="#990000">(</font><b><font color="#0000FF">this</font></b><font color="#990000">=</font><font color="#990000">=</font><font color="#990000">&amp;</font>src<font color="#990000">?</font> <font color="#990000">*</font><b><font color="#0000FF">this</font></b><font color="#990000">:</font> <b><font color="#000000">copy</font></b><font color="#990000">(</font>src<font color="#990000">)</font><font color="#990000">)</font><font color="#990000">;</font> <font color="#FF0000">}</font> <i><font color="#9A1900">//</font></i><i><font color="#9A1900">!&lt; dst = src</font></i>
	<i><font color="#9A1900">//</font></i><i><font color="#9A1900">! applys function fct element-by-element</font></i>
	Vec <font color="#990000">&amp;</font><b><font color="#000000">apply</font></b><font color="#990000">(</font>V_FCT_PTR fct<font color="#990000">)</font><font color="#990000">;</font>
	<font color="#009900">double</font> <b><font color="#000000">max</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">;</font> <i><font color="#9A1900">//</font></i><i><font color="#9A1900">!&lt; returns maximum Vec element</font></i>
	<font color="#009900">double</font> <b><font color="#000000">min</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">;</font> <i><font color="#9A1900">//</font></i><i><font color="#9A1900">!&lt; returns minimum Vec element</font></i>
	<font color="#009900">double</font> <b><font color="#000000">norm</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">;</font> <i><font color="#9A1900">//</font></i><i><font color="#9A1900">&lt; returns 2-norm (magnitude) of Vec</font></i>
	<font color="#009900">void</font> <b><font color="#000000">normalize</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">;</font> <i><font color="#9A1900">//</font></i><i><font color="#9A1900">&lt; convert Vec to unit magnitude</font></i>
	<i><font color="#9A1900">//</font></i><i><font color="#9A1900">! returns  dot product of a and b</font></i>
	<b><font color="#0000FF">static</font></b> <font color="#009900">double</font> <b><font color="#000000">dot</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> Vec <font color="#990000">&amp;</font>a<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> Vec <font color="#990000">&amp;</font>b<font color="#990000">)</font><font color="#990000">;</font>
	
	<i><font color="#9A1900">//</font></i><i><font color="#9A1900"> operator overloads</font></i>
	<b><font color="#0000FF">friend</font></b> Vec <b><font color="#0000FF">operator</font></b><font color="#990000">+</font><font color="#990000">(</font><b><font color="#0000FF">const</font></b> Vec <font color="#990000">&amp;</font>a<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> Vec <font color="#990000">&amp;</font>b<font color="#990000">)</font><font color="#990000">;</font>  <i><font color="#9A1900">//</font></i><i><font color="#9A1900">!&lt; returns a+b</font></i>
	<b><font color="#0000FF">friend</font></b> Vec <b><font color="#0000FF">operator</font></b><font color="#990000">-</font><font color="#990000">(</font><b><font color="#0000FF">const</font></b> Vec <font color="#990000">&amp;</font>a<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> Vec <font color="#990000">&amp;</font>b<font color="#990000">)</font><font color="#990000">;</font> <i><font color="#9A1900">//</font></i><i><font color="#9A1900">!&lt; returns a-b</font></i>
	<b><font color="#0000FF">friend</font></b> Vec <b><font color="#0000FF">operator</font></b><font color="#990000">*</font><font color="#990000">(</font><font color="#009900">double</font> c<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> Vec <font color="#990000">&amp;</font>a<font color="#990000">)</font><font color="#990000">;</font>     <i><font color="#9A1900">//</font></i><i><font color="#9A1900">!&lt; returns scalar multiplied by Vec</font></i>
	<b><font color="#0000FF">friend</font></b> Vec <b><font color="#0000FF">operator</font></b><font color="#990000">*</font><font color="#990000">(</font><b><font color="#0000FF">const</font></b> Vec <font color="#990000">&amp;</font>a<font color="#990000">,</font> <font color="#009900">double</font> c<font color="#990000">)</font><font color="#990000">;</font> <i><font color="#9A1900">//</font></i><i><font color="#9A1900">!&lt; returns Vec multiplied by scalar</font></i>
	<b><font color="#0000FF">friend</font></b> Vec <b><font color="#0000FF">operator</font></b><font color="#990000">*</font><font color="#990000">(</font><b><font color="#0000FF">const</font></b> Vec <font color="#990000">&amp;</font>a<font color="#990000">,</font> <font color="#009900">double</font> c<font color="#990000">)</font><font color="#990000">;</font> <i><font color="#9A1900">//</font></i><i><font color="#9A1900">!&lt; returns Vec divided by scalar</font></i>

<b><font color="#0000FF">private</font></b><font color="#990000">:</font>
	<font color="#009900">double</font> <font color="#990000">*</font>body<font color="#990000">;</font>	            <i><font color="#9A1900">//</font></i><i><font color="#9A1900">!&lt; contains the elements of the vector</font></i>
	<font color="#009900">int</font> n<font color="#990000">;</font>	                    <i><font color="#9A1900">//</font></i><i><font color="#9A1900">!&lt; number of elements in the vector</font></i>
	Vec <font color="#990000">&amp;</font><b><font color="#000000">copy</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> Vec <font color="#990000">&amp;</font>src<font color="#990000">)</font><font color="#990000">;</font>  <i><font color="#9A1900">//</font></i><i><font color="#9A1900">!&lt; replace current vector with src</font></i>
<font color="#FF0000">}</font><font color="#990000">;</font>

std<font color="#990000">:</font><font color="#990000">:</font>ostream<font color="#990000">&amp;</font> <b><font color="#0000FF">operator</font></b> <font color="#990000">&lt;</font><font color="#990000">&lt;</font> <font color="#990000">(</font>std<font color="#990000">:</font><font color="#990000">:</font>ostream<font color="#990000">&amp;</font> s<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> Vec<font color="#990000">&amp;</font> v<font color="#990000">)</font><font color="#990000">;</font>
<a name=Matrix>
<i><font color="#9A1900">//</font></i><i><font color="#9A1900">! defines a two-dimensional Matrix of doubles</font></i>
<b><font color="#0000FF">class</font></b> Matrix <font color="#FF0000">{</font>
<b><font color="#0000FF">public</font></b><font color="#990000">:</font>
	<i><font color="#9A1900">//</font></i><i><font color="#9A1900">! default (no argument) constructor	</font></i>
	<b><font color="#000000">Matrix</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">:</font> <b><font color="#000000">nrows</font></b><font color="#990000">(</font><font color="#993399">0</font><font color="#990000">)</font><font color="#990000">,</font> <b><font color="#000000">ncols</font></b><font color="#990000">(</font><font color="#993399">0</font><font color="#990000">)</font><font color="#990000">,</font> <b><font color="#000000">body</font></b><font color="#990000">(</font><font color="#993399">0</font><font color="#990000">)</font> <font color="#FF0000">{</font><font color="#FF0000">}</font>
	<i><font color="#9A1900">//</font></i><i><font color="#9A1900">! constructs a Matrix of specified size</font></i>
	<b><font color="#000000">Matrix</font></b><font color="#990000">(</font><font color="#009900">int</font> rows<font color="#990000">,</font> <font color="#009900">int</font> cols<font color="#990000">)</font><font color="#990000">:</font> <b><font color="#000000">nrows</font></b><font color="#990000">(</font><font color="#993399">0</font><font color="#990000">)</font><font color="#990000">,</font> <b><font color="#000000">ncols</font></b><font color="#990000">(</font><font color="#993399">0</font><font color="#990000">)</font><font color="#990000">,</font> <b><font color="#000000">body</font></b><font color="#990000">(</font><font color="#993399">0</font><font color="#990000">)</font> <font color="#FF0000">{</font> <b><font color="#000000">create</font></b><font color="#990000">(</font>rows<font color="#990000">,</font>cols<font color="#990000">)</font><font color="#990000">;</font><font color="#FF0000">}</font>
	<b><font color="#000000">Matrix</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> Matrix <font color="#990000">&amp;</font>src<font color="#990000">)</font><font color="#990000">:</font> <b><font color="#000000">nrows</font></b><font color="#990000">(</font><font color="#993399">0</font><font color="#990000">)</font><font color="#990000">,</font> <b><font color="#000000">ncols</font></b><font color="#990000">(</font><font color="#993399">0</font><font color="#990000">)</font><font color="#990000">,</font> <b><font color="#000000">body</font></b><font color="#990000">(</font><font color="#993399">0</font><font color="#990000">)</font> <font color="#FF0000">{</font> <b><font color="#000000">copy</font></b><font color="#990000">(</font>src<font color="#990000">)</font><font color="#990000">;</font> <font color="#FF0000">}</font> <i><font color="#9A1900">//</font></i><i><font color="#9A1900">!&lt; copy	constructor</font></i>
	<font color="#990000">~</font><b><font color="#000000">Matrix</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">;</font> <i><font color="#9A1900">//</font></i><i><font color="#9A1900">!&lt; destructor</font></i>
	<i><font color="#9A1900">//</font></i><i><font color="#9A1900">! creates(or resets) Matrix size and allocated space.</font></i>
	<font color="#009900">void</font> <b><font color="#000000">create</font></b><font color="#990000">(</font><font color="#009900">int</font> rows<font color="#990000">,</font> <font color="#009900">int</font> cols<font color="#990000">)</font><font color="#990000">;</font>
	<font color="#009900">int</font> <b><font color="#000000">cols</font></b><font color="#990000">(</font><font color="#990000">)</font><b><font color="#0000FF">const</font></b> <font color="#FF0000">{</font> <b><font color="#0000FF">return</font></b> ncols<font color="#990000">;</font> <font color="#FF0000">}</font> <i><font color="#9A1900">//</font></i><i><font color="#9A1900">!&lt; returns the number of columns</font></i>
	<font color="#009900">int</font> <b><font color="#000000">rows</font></b><font color="#990000">(</font><font color="#990000">)</font><b><font color="#0000FF">const</font></b> <font color="#FF0000">{</font> <b><font color="#0000FF">return</font></b> nrows<font color="#990000">;</font> <font color="#FF0000">}</font> <i><font color="#9A1900">//</font></i><i><font color="#9A1900">!&lt; returns the number of rows</font></i>
	<i><font color="#9A1900">//</font></i><i><font color="#9A1900">! set Matrix elements to v</font></i>
	Matrix <font color="#990000">&amp;</font><b><font color="#000000">set</font></b><font color="#990000">(</font><font color="#009900">double</font> v<font color="#990000">)</font><font color="#990000">;</font>
	Matrix <font color="#990000">&amp;</font><b><font color="#0000FF">operator</font></b> <font color="#990000">=</font><font color="#990000">(</font><b><font color="#0000FF">const</font></b> Matrix <font color="#990000">&amp;</font>mx<font color="#990000">)</font> <font color="#FF0000">{</font> <b><font color="#0000FF">return</font></b> <font color="#990000">(</font><b><font color="#0000FF">this</font></b><font color="#990000">=</font><font color="#990000">=</font><font color="#990000">&amp;</font>mx<font color="#990000">?</font> <font color="#990000">*</font><b><font color="#0000FF">this</font></b><font color="#990000">:</font> <b><font color="#000000">copy</font></b><font color="#990000">(</font>mx<font color="#990000">)</font><font color="#990000">)</font><font color="#990000">;</font> <font color="#FF0000">}</font>
	Matrix <b><font color="#0000FF">operator</font></b> <font color="#990000">*</font><font color="#990000">(</font><b><font color="#0000FF">const</font></b> Matrix <font color="#990000">&amp;</font>mx<font color="#990000">)</font> <b><font color="#0000FF">const</font></b><font color="#990000">;</font>
	<i><font color="#9A1900">//</font></i><i><font color="#9A1900">static Vec mul(const Matrix &amp;mx, const Vec &amp;v);</font></i>
	<i><font color="#9A1900">//</font></i><i><font color="#9A1900">static Vec mul(const Vec &amp;v, const Matrix &amp;mx);</font></i>
	<i><font color="#9A1900">//</font></i><i><font color="#9A1900">! swap rows</font></i>
	<font color="#009900">void</font> <b><font color="#000000">swaprows</font></b><font color="#990000">(</font><font color="#009900">int</font> i<font color="#990000">,</font> <font color="#009900">int</font> j<font color="#990000">)</font><font color="#990000">;</font>
	<i><font color="#9A1900">//</font></i><i><font color="#9A1900">! returns the transpose of the Matrix</font></i>
	Matrix <b><font color="#000000">transpose</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">;</font>
	<i><font color="#9A1900">//</font></i><i><font color="#9A1900">! returns a pointer to a Matrix row</font></i>
	<font color="#009900">double</font> <font color="#990000">*</font> <b><font color="#0000FF">operator</font></b> <font color="#990000">[</font><font color="#990000">]</font><font color="#990000">(</font><font color="#009900">int</font> n<font color="#990000">)</font> <b><font color="#0000FF">const</font></b> <font color="#FF0000">{</font> <b><font color="#0000FF">return</font></b> body<font color="#990000">[</font>n<font color="#990000">]</font><font color="#990000">;</font> <font color="#FF0000">}</font>
	<i><font color="#9A1900">//</font></i><i><font color="#9A1900">const double * operator [](int n) const { return body[n]; }</font></i>
	<i><font color="#9A1900">//</font></i><i><font color="#9A1900">! prints Matrix (using mprint)</font></i>
	<font color="#009900">void</font> <b><font color="#000000">print</font></b><font color="#990000">(</font><font color="#990000">)</font> <b><font color="#0000FF">const</font></b><font color="#990000">;</font>
	<i><font color="#9A1900">//</font></i><i><font color="#9A1900"> friends</font></i>
	<b><font color="#0000FF">friend</font></b> Vec <b><font color="#0000FF">operator</font></b> <font color="#990000">*</font><font color="#990000">(</font><b><font color="#0000FF">const</font></b> Matrix <font color="#990000">&amp;</font>mx<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> Vec <font color="#990000">&amp;</font>v<font color="#990000">)</font><font color="#990000">;</font> <i><font color="#9A1900">//</font></i><i><font color="#9A1900">!&lt; matix multipled by Vec</font></i>
	<b><font color="#0000FF">friend</font></b> Vec <b><font color="#0000FF">operator</font></b> <font color="#990000">*</font><font color="#990000">(</font><b><font color="#0000FF">const</font></b> Vec <font color="#990000">&amp;</font>v<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> Matrix <font color="#990000">&amp;</font>mx<font color="#990000">)</font><font color="#990000">;</font> <i><font color="#9A1900">//</font></i><i><font color="#9A1900">!&lt; Vec multiplied by Matrix</font></i>
<b><font color="#0000FF">private</font></b><font color="#990000">:</font>
	<font color="#009900">int</font> nrows<font color="#990000">;</font> <i><font color="#9A1900">//</font></i><i><font color="#9A1900">!&lt; number of rows in the Matrix</font></i>
	<font color="#009900">int</font> ncols<font color="#990000">;</font> <i><font color="#9A1900">//</font></i><i><font color="#9A1900">!&lt; number of columns in the Matrix</font></i>
	<font color="#009900">double</font> <font color="#990000">*</font><font color="#990000">*</font>body<font color="#990000">;</font> <i><font color="#9A1900">//</font></i><i><font color="#9A1900">!&lt; space allocated for the Matrix</font></i>
	Matrix <font color="#990000">&amp;</font><b><font color="#000000">copy</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> Matrix <font color="#990000">&amp;</font>mx<font color="#990000">)</font><font color="#990000">;</font> <i><font color="#9A1900">//</font></i><i><font color="#9A1900">!&lt; replaces Matrix with Matrix mx</font></i>

<font color="#FF0000">}</font><font color="#990000">;</font>
<i><font color="#9A1900">/*</font></i><i><font color="#9A1900">! returns the inner (or dot) product of a vector</font></i>
<i><font color="#9A1900"> * @param a first vector</font></i>
<i><font color="#9A1900"> * @param b second vector</font></i>
<i><font color="#9A1900"> * @returns (a dot b)</font></i>
<i><font color="#9A1900"> </font></i><i><font color="#9A1900">*/</font></i>
<b><font color="#0000FF">inline</font></b> <font color="#009900">double</font> Vec<font color="#990000">:</font><font color="#990000">:</font><b><font color="#000000">dot</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> Vec <font color="#990000">&amp;</font>a<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> Vec <font color="#990000">&amp;</font>b<font color="#990000">)</font>
<font color="#FF0000">{</font>
	<font color="#009900">double</font> sum <font color="#990000">=</font> <font color="#993399">0.0</font><font color="#990000">;</font>
	<font color="#009900">int</font> n <font color="#990000">=</font> a<font color="#990000">.</font><b><font color="#000000">length</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">;</font>
	<b><font color="#000000">assert</font></b><font color="#990000">(</font>b<font color="#990000">.</font><b><font color="#000000">length</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">=</font><font color="#990000">=</font>n<font color="#990000">)</font><font color="#990000">;</font>
	<b><font color="#0000FF">for</font></b> <font color="#990000">(</font><font color="#009900">int</font> i<font color="#990000">=</font><font color="#993399">0</font><font color="#990000">;</font> i<font color="#990000">&lt;</font>n<font color="#990000">;</font> i<font color="#990000">+</font><font color="#990000">+</font><font color="#990000">)</font> sum <font color="#990000">+</font><font color="#990000">=</font> a<font color="#990000">[</font>i<font color="#990000">]</font><font color="#990000">*</font>b<font color="#990000">[</font>i<font color="#990000">]</font><font color="#990000">;</font>
	<b><font color="#0000FF">return</font></b> sum<font color="#990000">;</font>
<font color="#FF0000">}</font>



Matrix <b><font color="#000000">identity</font></b><font color="#990000">(</font><font color="#009900">int</font> size<font color="#990000">)</font><font color="#990000">;</font>
Matrix <b><font color="#000000">diagonal</font></b><font color="#990000">(</font><font color="#009900">double</font> <font color="#990000">*</font>v<font color="#990000">,</font> <font color="#009900">int</font> size<font color="#990000">)</font><font color="#990000">;</font>
<font color="#009900">int</font> <b><font color="#000000">read_matrix</font></b><font color="#990000">(</font>Matrix <font color="#990000">&amp;</font>mx<font color="#990000">,</font> std<font color="#990000">:</font><font color="#990000">:</font>string <font color="#990000">&amp;</font>title<font color="#990000">,</font> FILE <font color="#990000">*</font>in<font color="#990000">)</font><font color="#990000">;</font>
<font color="#009900">void</font> <b><font color="#000000">print_vector</font></b><font color="#990000">(</font><font color="#009900">double</font> <font color="#990000">*</font>v<font color="#990000">,</font> <font color="#009900">int</font> n<font color="#990000">)</font><font color="#990000">;</font>
<font color="#009900">void</font> <b><font color="#000000">copy_matrix</font></b><font color="#990000">(</font>Matrix <font color="#990000">&amp;</font>dst<font color="#990000">,</font> Matrix <font color="#990000">&amp;</font>src<font color="#990000">)</font><font color="#990000">;</font>
<font color="#009900">double</font> <font color="#990000">*</font><b><font color="#000000">vector</font></b><font color="#990000">(</font><font color="#009900">int</font> length<font color="#990000">)</font><font color="#990000">;</font>
<font color="#009900">int</font> <font color="#990000">*</font><b><font color="#000000">ivector</font></b><font color="#990000">(</font><font color="#009900">int</font> length<font color="#990000">)</font><font color="#990000">;</font>
<font color="#009900">void</font> <b><font color="#000000">errmsg</font></b><font color="#990000">(</font><font color="#009900">char</font> <font color="#990000">*</font>text<font color="#990000">)</font><font color="#990000">;</font>

<b><font color="#000080">#endif</font></b>
</tt></pre>
<p><hr>


<h2><code>matrix.cpp</code></h2>

<p><hr><a name=matrix.cpp>
<!-- Generator: GNU source-highlight 2.1.2
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><i><font color="#9A1900">/*</font></i><i><font color="#9A1900"> matrix.cpp</font></i>
<i><font color="#9A1900">*</font></i>
<i><font color="#9A1900">*    Utility routines for allocating space for matrices and vectors,</font></i>
<i><font color="#9A1900">*    printing matrices and vectors, and copying one matrix to another.</font></i>
<i><font color="#9A1900">*/</font></i>
<b><font color="#000080">#include</font></b> <font color="#FF0000">&lt;stdio.h&gt;</font>
<b><font color="#000080">#include</font></b> <font color="#FF0000">&lt;stdlib.h&gt;</font>
<b><font color="#000080">#include</font></b> <font color="#FF0000">&lt;assert.h&gt;</font>
<b><font color="#000080">#include</font></b> <font color="#FF0000">&lt;math.h&gt;</font>
<b><font color="#000080">#include</font></b> <font color="#FF0000">&lt;iostream&gt;</font>
<b><font color="#0000FF">using</font></b> <b><font color="#0000FF">namespace</font></b> std<font color="#990000">;</font>
<b><font color="#000080">#include</font></b> <font color="#FF0000">"matrix.h"</font>

<font color="#009900">void</font> Matrix<font color="#990000">:</font><font color="#990000">:</font><b><font color="#000000">create</font></b><font color="#990000">(</font><font color="#009900">int</font> rows<font color="#990000">,</font> <font color="#009900">int</font> cols<font color="#990000">)</font>
<font color="#FF0000">{</font>
	<b><font color="#0000FF">if</font></b> <font color="#990000">(</font>rows<font color="#990000">=</font><font color="#990000">=</font>nrows <font color="#990000">&amp;</font><font color="#990000">&amp;</font> cols<font color="#990000">=</font><font color="#990000">=</font>ncols<font color="#990000">)</font> <b><font color="#0000FF">return</font></b><font color="#990000">;</font>
	<b><font color="#0000FF">while</font></b> <font color="#990000">(</font>nrows<font color="#990000">)</font> <b><font color="#0000FF">delete</font></b> <font color="#990000">[</font><font color="#990000">]</font> body<font color="#990000">[</font><font color="#990000">-</font><font color="#990000">-</font>nrows<font color="#990000">]</font><font color="#990000">;</font>
	<b><font color="#0000FF">if</font></b> <font color="#990000">(</font>body<font color="#990000">)</font> <b><font color="#0000FF">delete</font></b> body<font color="#990000">;</font>
	nrows <font color="#990000">=</font> rows<font color="#990000">;</font>
	ncols <font color="#990000">=</font> cols<font color="#990000">;</font>
	body <font color="#990000">=</font> <b><font color="#0000FF">new</font></b> <font color="#009900">double</font> <font color="#990000">*</font> <font color="#990000">[</font>nrows<font color="#990000">]</font><font color="#990000">;</font>
	<b><font color="#000000">assert</font></b><font color="#990000">(</font>body<font color="#990000">)</font><font color="#990000">;</font>
	<b><font color="#0000FF">for</font></b> <font color="#990000">(</font><font color="#009900">int</font> i<font color="#990000">=</font><font color="#993399">0</font><font color="#990000">;</font> i<font color="#990000">&lt;</font>nrows<font color="#990000">;</font> i<font color="#990000">+</font><font color="#990000">+</font><font color="#990000">)</font> <font color="#FF0000">{</font>
		body<font color="#990000">[</font>i<font color="#990000">]</font><font color="#990000">=</font> <b><font color="#0000FF">new</font></b> <font color="#009900">double</font><font color="#990000">[</font>ncols<font color="#990000">]</font><font color="#990000">;</font>
		<b><font color="#000000">assert</font></b><font color="#990000">(</font>body<font color="#990000">[</font>i<font color="#990000">]</font><font color="#990000">)</font><font color="#990000">;</font>
	<font color="#FF0000">}</font>
<font color="#FF0000">}</font>

<i><font color="#9A1900">/*</font></i><i><font color="#9A1900">!</font></i>
<i><font color="#9A1900">*   Copy Matrix src to the current Matrix</font></i>
<i><font color="#9A1900">*/</font></i>
Matrix <font color="#990000">&amp;</font>Matrix<font color="#990000">:</font><font color="#990000">:</font><b><font color="#000000">copy</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> Matrix <font color="#990000">&amp;</font>src<font color="#990000">)</font>
<font color="#FF0000">{</font>
	<font color="#009900">int</font> i<font color="#990000">,</font> j<font color="#990000">;</font>
	<font color="#009900">double</font> <font color="#990000">*</font>up<font color="#990000">,</font> <font color="#990000">*</font>vp<font color="#990000">;</font>
	<b><font color="#000000">create</font></b><font color="#990000">(</font>src<font color="#990000">.</font><b><font color="#000000">rows</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">,</font>src<font color="#990000">.</font><b><font color="#000000">cols</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">)</font><font color="#990000">;</font>
	<b><font color="#0000FF">for</font></b> <font color="#990000">(</font>i<font color="#990000">=</font><font color="#993399">0</font><font color="#990000">;</font> i<font color="#990000">&lt;</font>nrows<font color="#990000">;</font> i<font color="#990000">+</font><font color="#990000">+</font><font color="#990000">)</font> <font color="#FF0000">{</font>
		up <font color="#990000">=</font> src<font color="#990000">[</font>i<font color="#990000">]</font><font color="#990000">;</font>
		vp <font color="#990000">=</font> body<font color="#990000">[</font>i<font color="#990000">]</font><font color="#990000">;</font>
		<b><font color="#0000FF">for</font></b> <font color="#990000">(</font>j<font color="#990000">=</font><font color="#993399">0</font><font color="#990000">;</font> j<font color="#990000">&lt;</font>ncols<font color="#990000">;</font> j<font color="#990000">+</font><font color="#990000">+</font><font color="#990000">)</font> <font color="#990000">*</font>vp<font color="#990000">+</font><font color="#990000">+</font> <font color="#990000">=</font> <font color="#990000">*</font>up<font color="#990000">+</font><font color="#990000">+</font><font color="#990000">;</font>
	<font color="#FF0000">}</font>
	<b><font color="#0000FF">return</font></b> <font color="#990000">*</font><b><font color="#0000FF">this</font></b><font color="#990000">;</font>
<font color="#FF0000">}</font>

Matrix<font color="#990000">:</font><font color="#990000">:</font><font color="#990000">~</font><b><font color="#000000">Matrix</font></b><font color="#990000">(</font><font color="#990000">)</font>
<font color="#FF0000">{</font>
	<b><font color="#0000FF">while</font></b> <font color="#990000">(</font>nrows<font color="#990000">)</font> <b><font color="#0000FF">delete</font></b> <font color="#990000">[</font><font color="#990000">]</font> body<font color="#990000">[</font><font color="#990000">-</font><font color="#990000">-</font>nrows<font color="#990000">]</font><font color="#990000">;</font>
	<b><font color="#0000FF">delete</font></b> <font color="#990000">[</font><font color="#990000">]</font> body<font color="#990000">;</font>
<font color="#FF0000">}</font>

Matrix <font color="#990000">&amp;</font>Matrix<font color="#990000">:</font><font color="#990000">:</font><b><font color="#000000">set</font></b><font color="#990000">(</font><font color="#009900">double</font> v<font color="#990000">)</font>
<font color="#FF0000">{</font>
	<font color="#009900">int</font> i<font color="#990000">,</font> j<font color="#990000">;</font>
	<font color="#009900">double</font> <font color="#990000">*</font>p<font color="#990000">;</font>
	<b><font color="#0000FF">for</font></b> <font color="#990000">(</font>i<font color="#990000">=</font><font color="#993399">0</font><font color="#990000">;</font> i<font color="#990000">&lt;</font>nrows<font color="#990000">;</font> i<font color="#990000">+</font><font color="#990000">+</font><font color="#990000">)</font> <font color="#FF0000">{</font>
		p <font color="#990000">=</font> body<font color="#990000">[</font>i<font color="#990000">]</font><font color="#990000">;</font>
		<b><font color="#0000FF">for</font></b> <font color="#990000">(</font>j<font color="#990000">=</font><font color="#993399">0</font><font color="#990000">;</font> j<font color="#990000">&lt;</font>ncols<font color="#990000">;</font> j<font color="#990000">+</font><font color="#990000">+</font><font color="#990000">)</font> <font color="#990000">*</font>p<font color="#990000">+</font><font color="#990000">+</font> <font color="#990000">=</font> v<font color="#990000">;</font>
	<font color="#FF0000">}</font>
	<b><font color="#0000FF">return</font></b> <font color="#990000">*</font><b><font color="#0000FF">this</font></b><font color="#990000">;</font>
<font color="#FF0000">}</font>

<font color="#009900">void</font> Matrix<font color="#990000">:</font><font color="#990000">:</font><b><font color="#000000">swaprows</font></b><font color="#990000">(</font><font color="#009900">int</font> i<font color="#990000">,</font><font color="#009900">int</font> j<font color="#990000">)</font>
<font color="#FF0000">{</font>
	<font color="#009900">double</font> <font color="#990000">*</font>p <font color="#990000">=</font> body<font color="#990000">[</font>i<font color="#990000">]</font><font color="#990000">;</font>
	body<font color="#990000">[</font>i<font color="#990000">]</font><font color="#990000">=</font>body<font color="#990000">[</font>j<font color="#990000">]</font><font color="#990000">;</font>
	body<font color="#990000">[</font>j<font color="#990000">]</font><font color="#990000">=</font>p<font color="#990000">;</font>
<font color="#FF0000">}</font>

Matrix Matrix<font color="#990000">:</font><font color="#990000">:</font><b><font color="#000000">transpose</font></b><font color="#990000">(</font><font color="#990000">)</font>
<font color="#FF0000">{</font>
	<font color="#009900">int</font> i<font color="#990000">,</font> j<font color="#990000">;</font>
	Matrix <b><font color="#000000">out</font></b><font color="#990000">(</font>ncols<font color="#990000">,</font>nrows<font color="#990000">)</font><font color="#990000">;</font>
	<b><font color="#0000FF">for</font></b> <font color="#990000">(</font>i<font color="#990000">=</font><font color="#993399">0</font><font color="#990000">;</font> i<font color="#990000">&lt;</font>nrows<font color="#990000">;</font> i<font color="#990000">+</font><font color="#990000">+</font><font color="#990000">)</font> <font color="#FF0000">{</font>
		<b><font color="#0000FF">for</font></b> <font color="#990000">(</font>j<font color="#990000">=</font><font color="#993399">0</font><font color="#990000">;</font> j<font color="#990000">&lt;</font>ncols<font color="#990000">;</font> j<font color="#990000">+</font><font color="#990000">+</font><font color="#990000">)</font> <font color="#FF0000">{</font>
			out<font color="#990000">[</font>j<font color="#990000">]</font><font color="#990000">[</font>i<font color="#990000">]</font> <font color="#990000">=</font> body<font color="#990000">[</font>i<font color="#990000">]</font><font color="#990000">[</font>j<font color="#990000">]</font><font color="#990000">;</font>
		<font color="#FF0000">}</font>
	<font color="#FF0000">}</font>
	<b><font color="#0000FF">return</font></b> out<font color="#990000">;</font>
<font color="#FF0000">}</font>

<i><font color="#9A1900">//</font></i><i><font color="#9A1900">! Matrix multiplication</font></i>

Matrix Matrix<font color="#990000">:</font><font color="#990000">:</font><b><font color="#0000FF">operator</font></b> <font color="#990000">*</font><font color="#990000">(</font><b><font color="#0000FF">const</font></b> Matrix <font color="#990000">&amp;</font>mx<font color="#990000">)</font> <b><font color="#0000FF">const</font></b>
<font color="#FF0000">{</font>
	<font color="#009900">int</font> i<font color="#990000">,</font> j<font color="#990000">,</font> k<font color="#990000">;</font>
	<font color="#009900">double</font> sum<font color="#990000">;</font>
	<font color="#009900">double</font> <font color="#990000">*</font>vp<font color="#990000">;</font>
	<b><font color="#000000">assert</font></b><font color="#990000">(</font>ncols <font color="#990000">=</font><font color="#990000">=</font> mx<font color="#990000">.</font><b><font color="#000000">rows</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">)</font><font color="#990000">;</font> <i><font color="#9A1900">//</font></i><i><font color="#9A1900"> check for non-conforming Matrix multiplication</font></i>
	Matrix <b><font color="#000000">out</font></b><font color="#990000">(</font>nrows<font color="#990000">,</font>mx<font color="#990000">.</font><b><font color="#000000">cols</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">)</font><font color="#990000">;</font>
	<b><font color="#0000FF">for</font></b> <font color="#990000">(</font>i<font color="#990000">=</font><font color="#993399">0</font><font color="#990000">;</font> i<font color="#990000">&lt;</font>nrows<font color="#990000">;</font> i<font color="#990000">+</font><font color="#990000">+</font><font color="#990000">)</font> <font color="#FF0000">{</font>
		vp <font color="#990000">=</font> out<font color="#990000">[</font>i<font color="#990000">]</font><font color="#990000">;</font>
		<b><font color="#0000FF">for</font></b> <font color="#990000">(</font>j<font color="#990000">=</font><font color="#993399">0</font><font color="#990000">;</font> j<font color="#990000">&lt;</font>mx<font color="#990000">.</font><b><font color="#000000">cols</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">;</font> j<font color="#990000">+</font><font color="#990000">+</font><font color="#990000">)</font> <font color="#FF0000">{</font>
			sum <font color="#990000">=</font> <font color="#993399">0.0</font><font color="#990000">;</font>
			<b><font color="#0000FF">for</font></b> <font color="#990000">(</font>k<font color="#990000">=</font><font color="#993399">0</font><font color="#990000">;</font> k<font color="#990000">&lt;</font>ncols<font color="#990000">;</font> k<font color="#990000">+</font><font color="#990000">+</font><font color="#990000">)</font>
				sum <font color="#990000">+</font><font color="#990000">=</font> body<font color="#990000">[</font>i<font color="#990000">]</font><font color="#990000">[</font>k<font color="#990000">]</font> <font color="#990000">*</font> mx<font color="#990000">[</font>k<font color="#990000">]</font><font color="#990000">[</font>j<font color="#990000">]</font><font color="#990000">;</font>
			<font color="#990000">*</font>vp<font color="#990000">+</font><font color="#990000">+</font> <font color="#990000">=</font> sum<font color="#990000">;</font>
		<font color="#FF0000">}</font>
	<font color="#FF0000">}</font>
	<b><font color="#0000FF">return</font></b> out<font color="#990000">;</font>
<font color="#FF0000">}</font>

Vec <b><font color="#0000FF">operator</font></b> <font color="#990000">*</font><font color="#990000">(</font><b><font color="#0000FF">const</font></b> Matrix <font color="#990000">&amp;</font>mx<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> Vec <font color="#990000">&amp;</font>v<font color="#990000">)</font>
<font color="#FF0000">{</font>
	<font color="#009900">int</font> i<font color="#990000">,</font> j<font color="#990000">;</font>
	<font color="#009900">int</font> m <font color="#990000">=</font> mx<font color="#990000">.</font><b><font color="#000000">rows</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">;</font>
	<font color="#009900">int</font> n <font color="#990000">=</font> mx<font color="#990000">.</font><b><font color="#000000">cols</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">;</font>
	<font color="#009900">double</font> sum<font color="#990000">;</font>
	<b><font color="#000000">assert</font></b><font color="#990000">(</font>m<font color="#990000">&gt;</font><font color="#993399">0</font> <font color="#990000">&amp;</font><font color="#990000">&amp;</font> n<font color="#990000">&gt;</font><font color="#993399">0</font><font color="#990000">)</font><font color="#990000">;</font>
	<b><font color="#000000">assert</font></b><font color="#990000">(</font>n<font color="#990000">=</font><font color="#990000">=</font>v<font color="#990000">.</font><b><font color="#000000">length</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">)</font><font color="#990000">;</font>
	Vec <b><font color="#000000">vout</font></b><font color="#990000">(</font>m<font color="#990000">)</font><font color="#990000">;</font>
	<b><font color="#0000FF">for</font></b> <font color="#990000">(</font>i<font color="#990000">=</font><font color="#993399">0</font><font color="#990000">;</font> i<font color="#990000">&lt;</font>m<font color="#990000">;</font> i<font color="#990000">+</font><font color="#990000">+</font><font color="#990000">)</font> <font color="#FF0000">{</font>
		sum <font color="#990000">=</font> <font color="#993399">0.0</font><font color="#990000">;</font>
		<font color="#009900">double</font> <font color="#990000">*</font>ptr <font color="#990000">=</font> mx<font color="#990000">[</font>i<font color="#990000">]</font><font color="#990000">;</font>
		<b><font color="#0000FF">for</font></b> <font color="#990000">(</font>j<font color="#990000">=</font><font color="#993399">0</font><font color="#990000">;</font> j<font color="#990000">&lt;</font>n<font color="#990000">;</font> j<font color="#990000">+</font><font color="#990000">+</font><font color="#990000">)</font> sum <font color="#990000">+</font><font color="#990000">=</font> <font color="#990000">(</font><font color="#990000">*</font>ptr<font color="#990000">+</font><font color="#990000">+</font><font color="#990000">)</font> <font color="#990000">*</font> v<font color="#990000">[</font>j<font color="#990000">]</font><font color="#990000">;</font>
		vout<font color="#990000">[</font>i<font color="#990000">]</font> <font color="#990000">=</font> sum<font color="#990000">;</font>
	<font color="#FF0000">}</font>
	<b><font color="#0000FF">return</font></b> vout<font color="#990000">;</font>
<font color="#FF0000">}</font>

Vec <b><font color="#0000FF">operator</font></b> <font color="#990000">*</font><font color="#990000">(</font><b><font color="#0000FF">const</font></b> Vec <font color="#990000">&amp;</font>v<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> Matrix <font color="#990000">&amp;</font>mx<font color="#990000">)</font>
<font color="#FF0000">{</font>
	<font color="#009900">int</font> i<font color="#990000">,</font> j<font color="#990000">;</font>
	<font color="#009900">int</font> m <font color="#990000">=</font> mx<font color="#990000">.</font><b><font color="#000000">rows</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">;</font>
	<font color="#009900">int</font> n <font color="#990000">=</font> mx<font color="#990000">.</font><b><font color="#000000">cols</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">;</font>
	<font color="#009900">double</font> sum<font color="#990000">;</font>
	<b><font color="#000000">assert</font></b><font color="#990000">(</font>m<font color="#990000">&gt;</font><font color="#993399">0</font> <font color="#990000">&amp;</font><font color="#990000">&amp;</font> n<font color="#990000">&gt;</font><font color="#993399">0</font><font color="#990000">)</font><font color="#990000">;</font>
	<b><font color="#000000">assert</font></b><font color="#990000">(</font>m<font color="#990000">=</font><font color="#990000">=</font>v<font color="#990000">.</font><b><font color="#000000">length</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">)</font><font color="#990000">;</font>
	Vec <b><font color="#000000">vout</font></b><font color="#990000">(</font>n<font color="#990000">)</font><font color="#990000">;</font>
	<b><font color="#0000FF">for</font></b> <font color="#990000">(</font>j<font color="#990000">=</font><font color="#993399">0</font><font color="#990000">;</font> j<font color="#990000">&lt;</font>n<font color="#990000">;</font> j<font color="#990000">+</font><font color="#990000">+</font><font color="#990000">)</font> <font color="#FF0000">{</font>
		sum <font color="#990000">=</font> <font color="#993399">0.0</font><font color="#990000">;</font>
		<b><font color="#0000FF">for</font></b> <font color="#990000">(</font>i<font color="#990000">=</font><font color="#993399">0</font><font color="#990000">;</font> i<font color="#990000">&lt;</font>m<font color="#990000">;</font> i<font color="#990000">+</font><font color="#990000">+</font><font color="#990000">)</font> sum <font color="#990000">+</font><font color="#990000">=</font> v<font color="#990000">[</font>i<font color="#990000">]</font> <font color="#990000">*</font> mx<font color="#990000">[</font>i<font color="#990000">]</font><font color="#990000">[</font>j<font color="#990000">]</font><font color="#990000">;</font>
		vout<font color="#990000">[</font>j<font color="#990000">]</font> <font color="#990000">=</font> sum<font color="#990000">;</font>
	<font color="#FF0000">}</font>
	<b><font color="#0000FF">return</font></b> vout<font color="#990000">;</font>
<font color="#FF0000">}</font>

<i><font color="#9A1900">//</font></i><i><font color="#9A1900">!    create an Identity Matrix</font></i>
Matrix <b><font color="#000000">identity</font></b><font color="#990000">(</font><font color="#009900">int</font> size<font color="#990000">)</font>
<font color="#FF0000">{</font>
	<font color="#009900">int</font> i<font color="#990000">,</font> j<font color="#990000">;</font>
	<font color="#009900">double</font> <font color="#990000">*</font>vp<font color="#990000">;</font>
	Matrix <b><font color="#000000">out</font></b><font color="#990000">(</font>size<font color="#990000">,</font>size<font color="#990000">)</font><font color="#990000">;</font>
	<b><font color="#0000FF">for</font></b> <font color="#990000">(</font>i<font color="#990000">=</font><font color="#993399">0</font><font color="#990000">;</font> i<font color="#990000">&lt;</font>size<font color="#990000">;</font> i<font color="#990000">+</font><font color="#990000">+</font><font color="#990000">)</font> <font color="#FF0000">{</font>
		vp <font color="#990000">=</font> out<font color="#990000">[</font>i<font color="#990000">]</font><font color="#990000">;</font>
		<b><font color="#0000FF">for</font></b> <font color="#990000">(</font>j<font color="#990000">=</font><font color="#993399">0</font><font color="#990000">;</font> j<font color="#990000">&lt;</font>size<font color="#990000">;</font> j<font color="#990000">+</font><font color="#990000">+</font><font color="#990000">)</font> vp<font color="#990000">[</font>j<font color="#990000">]</font><font color="#990000">=</font><font color="#993399">0.0</font><font color="#990000">;</font>
		vp<font color="#990000">[</font>i<font color="#990000">]</font> <font color="#990000">=</font> <font color="#993399">1.0</font><font color="#990000">;</font>
	<font color="#FF0000">}</font>
	<b><font color="#0000FF">return</font></b> out<font color="#990000">;</font>
<font color="#FF0000">}</font>


<i><font color="#9A1900">//</font></i><i><font color="#9A1900">! create a diagonal Matrix</font></i>
<i><font color="#9A1900">/*</font></i><i><font color="#9A1900">!</font></i>
<i><font color="#9A1900"> *  @param v is an array of diagonal elements</font></i>
<i><font color="#9A1900"> *  @param size is the length of the array</font></i>
<i><font color="#9A1900"> *  </font></i>
<i><font color="#9A1900"> </font></i><i><font color="#9A1900">*/</font></i>
Matrix <b><font color="#000000">diagonal</font></b><font color="#990000">(</font><font color="#009900">double</font> <font color="#990000">*</font>v<font color="#990000">,</font> <font color="#009900">int</font> size<font color="#990000">)</font>
<font color="#FF0000">{</font>
	<font color="#009900">int</font> i<font color="#990000">,</font> j<font color="#990000">;</font>
	<font color="#009900">double</font> <font color="#990000">*</font>vp<font color="#990000">;</font>
	Matrix <b><font color="#000000">out</font></b><font color="#990000">(</font>size<font color="#990000">,</font>size<font color="#990000">)</font><font color="#990000">;</font>
	<b><font color="#0000FF">for</font></b> <font color="#990000">(</font>i<font color="#990000">=</font><font color="#993399">0</font><font color="#990000">;</font> i<font color="#990000">&lt;</font>size<font color="#990000">;</font> i<font color="#990000">+</font><font color="#990000">+</font><font color="#990000">)</font> <font color="#FF0000">{</font>
		vp <font color="#990000">=</font> out<font color="#990000">[</font>i<font color="#990000">]</font><font color="#990000">;</font>
		<b><font color="#0000FF">for</font></b> <font color="#990000">(</font>j<font color="#990000">=</font><font color="#993399">0</font><font color="#990000">;</font> j<font color="#990000">&lt;</font>size<font color="#990000">;</font> j<font color="#990000">+</font><font color="#990000">+</font><font color="#990000">)</font> vp<font color="#990000">[</font>j<font color="#990000">]</font><font color="#990000">=</font><font color="#993399">0.0</font><font color="#990000">;</font>
		vp<font color="#990000">[</font>i<font color="#990000">]</font> <font color="#990000">=</font> v<font color="#990000">[</font>i<font color="#990000">]</font><font color="#990000">;</font>
	<font color="#FF0000">}</font>
	<b><font color="#0000FF">return</font></b> out<font color="#990000">;</font>
<font color="#FF0000">}</font>

<i><font color="#9A1900">//</font></i><i><font color="#9A1900">! read Matrix from text file</font></i>
<i><font color="#9A1900">/*</font></i><i><font color="#9A1900">! @param mx destination Matrix</font></i>
<i><font color="#9A1900"> *  @param title c-string comment (remainder of header line)</font></i>
<i><font color="#9A1900"> *  @param in input file</font></i>
<i><font color="#9A1900"> *  </font></i>
<i><font color="#9A1900">*  The first two entries are number of rows and columns.\n</font></i>
<i><font color="#9A1900">*  The rest of the line is a title.\n</font></i>
<i><font color="#9A1900">*  The body of the Matrix follows.\n</font></i>
<i><font color="#9A1900">*/</font></i>

<font color="#009900">int</font> <b><font color="#000000">read_matrix</font></b><font color="#990000">(</font>Matrix <font color="#990000">&amp;</font>mx<font color="#990000">,</font> string <font color="#990000">&amp;</font>title<font color="#990000">,</font> FILE <font color="#990000">*</font>in<font color="#990000">)</font>
<font color="#FF0000">{</font>
	<font color="#009900">int</font> i<font color="#990000">,</font> j<font color="#990000">;</font>
	<font color="#009900">int</font> nrows<font color="#990000">,</font> ncols<font color="#990000">;</font>
	<font color="#009900">double</font> <font color="#990000">*</font>v<font color="#990000">;</font>
	<font color="#009900">double</font> vin<font color="#990000">;</font>
	<font color="#009900">char</font> <font color="#990000">*</font>cp<font color="#990000">;</font>
	<font color="#009900">char</font> buf<font color="#990000">[</font><font color="#993399">256</font><font color="#990000">]</font><font color="#990000">;</font>

	<b><font color="#000000">fscanf_s</font></b><font color="#990000">(</font>in<font color="#990000">,</font><font color="#FF0000">" %d %d"</font><font color="#990000">,</font><font color="#990000">&amp;</font>nrows<font color="#990000">,</font><font color="#990000">&amp;</font>ncols<font color="#990000">)</font><font color="#990000">;</font>
	<b><font color="#0000FF">if</font></b> <font color="#990000">(</font><b><font color="#000000">feof</font></b><font color="#990000">(</font>in<font color="#990000">)</font><font color="#990000">)</font> <b><font color="#0000FF">return</font></b> <font color="#990000">-</font><font color="#993399">1</font><font color="#990000">;</font>
	<b><font color="#000000">fgets</font></b><font color="#990000">(</font>buf<font color="#990000">,</font><font color="#993399">255</font><font color="#990000">,</font>in<font color="#990000">)</font><font color="#990000">;</font>
	<b><font color="#0000FF">if</font></b> <font color="#990000">(</font><b><font color="#000000">feof</font></b><font color="#990000">(</font>in<font color="#990000">)</font><font color="#990000">)</font> <b><font color="#0000FF">return</font></b> <font color="#990000">-</font><font color="#993399">1</font><font color="#990000">;</font>
	cp <font color="#990000">=</font> buf<font color="#990000">;</font>
	<b><font color="#0000FF">while</font></b> <font color="#990000">(</font><font color="#990000">*</font>cp<font color="#990000">)</font> <font color="#FF0000">{</font>
		<b><font color="#0000FF">if</font></b> <font color="#990000">(</font><font color="#990000">*</font>cp<font color="#990000">=</font><font color="#990000">=</font><font color="#FF0000">'\n'</font><font color="#990000">)</font> <font color="#990000">*</font>cp <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">;</font>
		<b><font color="#0000FF">else</font></b> cp<font color="#990000">+</font><font color="#990000">+</font><font color="#990000">;</font>
	<font color="#FF0000">}</font>
	title <font color="#990000">=</font> buf<font color="#990000">;</font>
	mx<font color="#990000">.</font><b><font color="#000000">create</font></b><font color="#990000">(</font>nrows<font color="#990000">,</font>ncols<font color="#990000">)</font><font color="#990000">;</font>
	<b><font color="#0000FF">for</font></b> <font color="#990000">(</font>j<font color="#990000">=</font><font color="#993399">0</font><font color="#990000">;</font> j<font color="#990000">&lt;</font>nrows<font color="#990000">;</font> j<font color="#990000">+</font><font color="#990000">+</font><font color="#990000">)</font> <font color="#FF0000">{</font>
		v  <font color="#990000">=</font> mx<font color="#990000">[</font>j<font color="#990000">]</font><font color="#990000">;</font>
		<b><font color="#0000FF">for</font></b> <font color="#990000">(</font>i<font color="#990000">=</font><font color="#993399">0</font><font color="#990000">;</font> i<font color="#990000">&lt;</font>ncols<font color="#990000">;</font> i<font color="#990000">+</font><font color="#990000">+</font><font color="#990000">)</font> <font color="#FF0000">{</font>
			<b><font color="#000000">fscanf_s</font></b><font color="#990000">(</font>in<font color="#990000">,</font><font color="#FF0000">" %lf"</font><font color="#990000">,</font><font color="#990000">&amp;</font>vin<font color="#990000">)</font><font color="#990000">;</font>
			<font color="#990000">*</font>v<font color="#990000">+</font><font color="#990000">+</font> <font color="#990000">=</font> vin<font color="#990000">;</font>
		<font color="#FF0000">}</font>
		<b><font color="#0000FF">if</font></b> <font color="#990000">(</font><b><font color="#000000">feof</font></b><font color="#990000">(</font>in<font color="#990000">)</font><font color="#990000">)</font> <font color="#FF0000">{</font>
			<b><font color="#000000">printf</font></b><font color="#990000">(</font><font color="#FF0000">"\nerror reading %s\n"</font><font color="#990000">,</font>title<font color="#990000">)</font><font color="#990000">;</font>
			<b><font color="#000000">printf</font></b><font color="#990000">(</font><font color="#FF0000">"Matrix has %d rows and %d columns\n"</font><font color="#990000">,</font>
				mx<font color="#990000">.</font><b><font color="#000000">rows</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">,</font>mx<font color="#990000">.</font><b><font color="#000000">cols</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">)</font><font color="#990000">;</font>
			<b><font color="#000000">printf</font></b><font color="#990000">(</font><font color="#FF0000">"Unexpected EOF reading row %d"</font><font color="#990000">,</font>j<font color="#990000">+</font><font color="#993399">1</font><font color="#990000">)</font><font color="#990000">;</font>
			<b><font color="#0000FF">return</font></b> <font color="#990000">-</font><font color="#993399">1</font><font color="#990000">;</font>
		<font color="#FF0000">}</font>
	<font color="#FF0000">}</font>
	<b><font color="#0000FF">return</font></b> <font color="#993399">0</font><font color="#990000">;</font>
<font color="#FF0000">}</font>



<i><font color="#9A1900">//</font></i><i><font color="#9A1900">! create memory for elements of vector</font></i>
<font color="#009900">void</font> Vec<font color="#990000">:</font><font color="#990000">:</font><b><font color="#000000">create</font></b><font color="#990000">(</font><font color="#009900">int</font> size<font color="#990000">)</font>
<font color="#FF0000">{</font>
	<b><font color="#000000">assert</font></b><font color="#990000">(</font>size<font color="#990000">)</font><font color="#990000">;</font>
	<b><font color="#0000FF">if</font></b> <font color="#990000">(</font>size <font color="#990000">=</font><font color="#990000">=</font> n<font color="#990000">)</font> <b><font color="#0000FF">return</font></b><font color="#990000">;</font>
	<b><font color="#0000FF">if</font></b> <font color="#990000">(</font>body <font color="#990000">!</font><font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">)</font> <b><font color="#0000FF">delete</font></b> <font color="#990000">[</font><font color="#990000">]</font> body<font color="#990000">;</font>
	body <font color="#990000">=</font> <b><font color="#0000FF">new</font></b> <font color="#009900">double</font><font color="#990000">[</font>size<font color="#990000">]</font><font color="#990000">;</font>
	<b><font color="#000000">assert</font></b><font color="#990000">(</font>body<font color="#990000">!</font><font color="#990000">=</font><font color="#993399">0</font><font color="#990000">)</font><font color="#990000">;</font>
	n <font color="#990000">=</font> size<font color="#990000">;</font>
	<i><font color="#9A1900">//</font></i><i><font color="#9A1900">memset((void *)body, 0, (size_t)(n*sizeof(double));</font></i>
<font color="#FF0000">}</font>
<i><font color="#9A1900">//</font></i><i><font color="#9A1900">! copy constructor</font></i>
Vec <font color="#990000">&amp;</font>Vec<font color="#990000">:</font><font color="#990000">:</font><b><font color="#000000">copy</font></b><font color="#990000">(</font><b><font color="#0000FF">const</font></b> Vec <font color="#990000">&amp;</font>src<font color="#990000">)</font>
<font color="#FF0000">{</font>
	<font color="#009900">int</font> size <font color="#990000">=</font> src<font color="#990000">.</font><b><font color="#000000">length</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">;</font>
	<b><font color="#000000">create</font></b><font color="#990000">(</font>size<font color="#990000">)</font><font color="#990000">;</font>
	<b><font color="#0000FF">for</font></b> <font color="#990000">(</font><font color="#009900">int</font> i<font color="#990000">=</font><font color="#993399">0</font><font color="#990000">;</font> i<font color="#990000">&lt;</font>n<font color="#990000">;</font> i<font color="#990000">+</font><font color="#990000">+</font><font color="#990000">)</font> body<font color="#990000">[</font>i<font color="#990000">]</font> <font color="#990000">=</font> src<font color="#990000">[</font>i<font color="#990000">]</font><font color="#990000">;</font>
	<b><font color="#0000FF">return</font></b> <font color="#990000">*</font><b><font color="#0000FF">this</font></b><font color="#990000">;</font>
<font color="#FF0000">}</font>

<font color="#009900">double</font> Vec<font color="#990000">:</font><font color="#990000">:</font><b><font color="#000000">max</font></b><font color="#990000">(</font><font color="#990000">)</font>
<font color="#FF0000">{</font>
	<font color="#009900">double</font> vmax <font color="#990000">=</font> body<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]</font><font color="#990000">;</font>
	<b><font color="#0000FF">for</font></b> <font color="#990000">(</font><font color="#009900">int</font> i<font color="#990000">=</font><font color="#993399">1</font><font color="#990000">;</font> i<font color="#990000">&lt;</font>n<font color="#990000">;</font> i<font color="#990000">+</font><font color="#990000">+</font><font color="#990000">)</font> <b><font color="#0000FF">if</font></b> <font color="#990000">(</font>body<font color="#990000">[</font>i<font color="#990000">]</font><font color="#990000">&gt;</font>vmax<font color="#990000">)</font> vmax <font color="#990000">=</font> body<font color="#990000">[</font>i<font color="#990000">]</font><font color="#990000">;</font>
	<b><font color="#0000FF">return</font></b> vmax<font color="#990000">;</font>
<font color="#FF0000">}</font>

<font color="#009900">double</font> Vec<font color="#990000">:</font><font color="#990000">:</font><b><font color="#000000">min</font></b><font color="#990000">(</font><font color="#990000">)</font>
<font color="#FF0000">{</font>
	<font color="#009900">double</font> vmin <font color="#990000">=</font> body<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]</font><font color="#990000">;</font>
	<b><font color="#0000FF">for</font></b> <font color="#990000">(</font><font color="#009900">int</font> i<font color="#990000">=</font><font color="#993399">1</font><font color="#990000">;</font> i<font color="#990000">&lt;</font>n<font color="#990000">;</font> i<font color="#990000">+</font><font color="#990000">+</font><font color="#990000">)</font> <b><font color="#0000FF">if</font></b> <font color="#990000">(</font>body<font color="#990000">[</font>i<font color="#990000">]</font><font color="#990000">&lt;</font>vmin<font color="#990000">)</font> vmin <font color="#990000">=</font> body<font color="#990000">[</font>i<font color="#990000">]</font><font color="#990000">;</font>
	<b><font color="#0000FF">return</font></b> vmin<font color="#990000">;</font>
<font color="#FF0000">}</font>

<font color="#009900">double</font> Vec<font color="#990000">:</font><font color="#990000">:</font><b><font color="#000000">norm</font></b><font color="#990000">(</font><font color="#990000">)</font>
<font color="#FF0000">{</font>
	<font color="#009900">double</font> sum <font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">;</font><font color="#993399">0</font><font color="#990000">;</font>
	<b><font color="#0000FF">for</font></b> <font color="#990000">(</font><font color="#009900">int</font> i<font color="#990000">=</font><font color="#993399">0</font><font color="#990000">;</font> i<font color="#990000">&lt;</font>n<font color="#990000">;</font> i<font color="#990000">+</font><font color="#990000">+</font><font color="#990000">)</font> sum <font color="#990000">+</font><font color="#990000">=</font> body<font color="#990000">[</font>i<font color="#990000">]</font><font color="#990000">*</font>body<font color="#990000">[</font>i<font color="#990000">]</font><font color="#990000">;</font>
	<b><font color="#0000FF">return</font></b> <b><font color="#000000">sqrt</font></b><font color="#990000">(</font>sum<font color="#990000">)</font><font color="#990000">;</font>
<font color="#FF0000">}</font>

<font color="#009900">void</font> Vec<font color="#990000">:</font><font color="#990000">:</font><b><font color="#000000">normalize</font></b><font color="#990000">(</font><font color="#990000">)</font>
<font color="#FF0000">{</font>
	<font color="#009900">double</font> vnorm <font color="#990000">=</font> <b><font color="#000000">norm</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">;</font>
	<b><font color="#0000FF">for</font></b> <font color="#990000">(</font><font color="#009900">int</font> i<font color="#990000">=</font><font color="#993399">0</font><font color="#990000">;</font> i<font color="#990000">&lt;</font>n<font color="#990000">;</font> i<font color="#990000">+</font><font color="#990000">+</font><font color="#990000">)</font> body<font color="#990000">[</font>i<font color="#990000">]</font> <font color="#990000">/</font><font color="#990000">=</font> vnorm<font color="#990000">;</font>
<font color="#FF0000">}</font>
	

Vec<font color="#990000">&amp;</font> Vec<font color="#990000">:</font><font color="#990000">:</font><b><font color="#000000">apply</font></b><font color="#990000">(</font>V_FCT_PTR fct<font color="#990000">)</font>
<font color="#FF0000">{</font>
	<b><font color="#0000FF">for</font></b> <font color="#990000">(</font><font color="#009900">int</font> i<font color="#990000">=</font><font color="#993399">0</font><font color="#990000">;</font> i<font color="#990000">&lt;</font>n<font color="#990000">;</font> i<font color="#990000">+</font><font color="#990000">+</font><font color="#990000">)</font> body<font color="#990000">[</font>i<font color="#990000">]</font> <font color="#990000">=</font> <font color="#990000">(</font><font color="#990000">*</font>fct<font color="#990000">)</font><font color="#990000">(</font>body<font color="#990000">[</font>i<font color="#990000">]</font><font color="#990000">)</font><font color="#990000">;</font>
	<b><font color="#0000FF">return</font></b> <font color="#990000">*</font><b><font color="#0000FF">this</font></b><font color="#990000">;</font>
<font color="#FF0000">}</font>

<i><font color="#9A1900">//</font></i><i><font color="#9A1900">! returns a + b</font></i>
Vec <b><font color="#0000FF">operator</font></b> <font color="#990000">+</font><font color="#990000">(</font><b><font color="#0000FF">const</font></b> Vec <font color="#990000">&amp;</font>a<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> Vec <font color="#990000">&amp;</font>b<font color="#990000">)</font>
<font color="#FF0000">{</font>
	<font color="#009900">int</font> n <font color="#990000">=</font> a<font color="#990000">.</font><b><font color="#000000">length</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">;</font>
	<b><font color="#000000">assert</font></b><font color="#990000">(</font>b<font color="#990000">.</font><b><font color="#000000">length</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">=</font><font color="#990000">=</font>n<font color="#990000">)</font><font color="#990000">;</font>
	Vec <b><font color="#000000">sum</font></b><font color="#990000">(</font>n<font color="#990000">)</font><font color="#990000">;</font>
	<b><font color="#0000FF">for</font></b> <font color="#990000">(</font><font color="#009900">int</font> i<font color="#990000">=</font><font color="#993399">0</font><font color="#990000">;</font> i<font color="#990000">&lt;</font>n<font color="#990000">;</font> i<font color="#990000">+</font><font color="#990000">+</font><font color="#990000">)</font> sum<font color="#990000">[</font>i<font color="#990000">]</font> <font color="#990000">=</font> a<font color="#990000">[</font>i<font color="#990000">]</font> <font color="#990000">+</font> b<font color="#990000">[</font>i<font color="#990000">]</font><font color="#990000">;</font>
	<b><font color="#0000FF">return</font></b> sum<font color="#990000">;</font>
<font color="#FF0000">}</font>

<i><font color="#9A1900">//</font></i><i><font color="#9A1900">! returns a - b</font></i>
Vec <b><font color="#0000FF">operator</font></b> <font color="#990000">-</font><font color="#990000">(</font><b><font color="#0000FF">const</font></b> Vec <font color="#990000">&amp;</font>a<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> Vec <font color="#990000">&amp;</font>b<font color="#990000">)</font>
<font color="#FF0000">{</font>
	<font color="#009900">int</font> n <font color="#990000">=</font> a<font color="#990000">.</font><b><font color="#000000">length</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">;</font>
	<b><font color="#000000">assert</font></b><font color="#990000">(</font>b<font color="#990000">.</font><b><font color="#000000">length</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">=</font><font color="#990000">=</font>n<font color="#990000">)</font><font color="#990000">;</font>
	Vec <b><font color="#000000">diff</font></b><font color="#990000">(</font>n<font color="#990000">)</font><font color="#990000">;</font>
	<b><font color="#0000FF">for</font></b> <font color="#990000">(</font><font color="#009900">int</font> i<font color="#990000">=</font><font color="#993399">0</font><font color="#990000">;</font> i<font color="#990000">&lt;</font>n<font color="#990000">;</font> i<font color="#990000">+</font><font color="#990000">+</font><font color="#990000">)</font> diff<font color="#990000">[</font>i<font color="#990000">]</font> <font color="#990000">=</font> a<font color="#990000">[</font>i<font color="#990000">]</font> <font color="#990000">-</font> b<font color="#990000">[</font>i<font color="#990000">]</font><font color="#990000">;</font>
	<b><font color="#0000FF">return</font></b> diff<font color="#990000">;</font>
<font color="#FF0000">}</font>

<i><font color="#9A1900">//</font></i><i><font color="#9A1900">! returns scalar multiplied by a vector</font></i>
Vec <b><font color="#0000FF">operator</font></b> <font color="#990000">*</font><font color="#990000">(</font><font color="#009900">double</font> c<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> Vec <font color="#990000">&amp;</font>a<font color="#990000">)</font>
<font color="#FF0000">{</font>
	<font color="#009900">int</font> n <font color="#990000">=</font> a<font color="#990000">.</font><b><font color="#000000">length</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">;</font>
	Vec <b><font color="#000000">vout</font></b><font color="#990000">(</font>n<font color="#990000">)</font><font color="#990000">;</font>
	<b><font color="#0000FF">for</font></b> <font color="#990000">(</font><font color="#009900">int</font> i<font color="#990000">=</font><font color="#993399">0</font><font color="#990000">;</font> i<font color="#990000">&lt;</font>n<font color="#990000">;</font> i<font color="#990000">+</font><font color="#990000">+</font><font color="#990000">)</font> vout<font color="#990000">[</font>i<font color="#990000">]</font> <font color="#990000">=</font> c<font color="#990000">*</font>a<font color="#990000">[</font>i<font color="#990000">]</font><font color="#990000">;</font>
	<b><font color="#0000FF">return</font></b> vout<font color="#990000">;</font>
<font color="#FF0000">}</font>

<i><font color="#9A1900">//</font></i><i><font color="#9A1900">! returns vector mutliplied by a scalar</font></i>
Vec <b><font color="#0000FF">operator</font></b> <font color="#990000">*</font><font color="#990000">(</font><b><font color="#0000FF">const</font></b> Vec <font color="#990000">&amp;</font>a<font color="#990000">,</font> <font color="#009900">double</font> c<font color="#990000">)</font>
<font color="#FF0000">{</font>
	<font color="#009900">int</font> n <font color="#990000">=</font> a<font color="#990000">.</font><b><font color="#000000">length</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">;</font>
	Vec <b><font color="#000000">vout</font></b><font color="#990000">(</font>n<font color="#990000">)</font><font color="#990000">;</font>
	<b><font color="#0000FF">for</font></b> <font color="#990000">(</font><font color="#009900">int</font> i<font color="#990000">=</font><font color="#993399">0</font><font color="#990000">;</font> i<font color="#990000">&lt;</font>n<font color="#990000">;</font> i<font color="#990000">+</font><font color="#990000">+</font><font color="#990000">)</font> vout<font color="#990000">[</font>i<font color="#990000">]</font> <font color="#990000">=</font> c<font color="#990000">*</font>a<font color="#990000">[</font>i<font color="#990000">]</font><font color="#990000">;</font>
	<b><font color="#0000FF">return</font></b> vout<font color="#990000">;</font>
<font color="#FF0000">}</font>

<i><font color="#9A1900">//</font></i><i><font color="#9A1900">! returns vector divided by a scalar</font></i>
Vec <b><font color="#0000FF">operator</font></b> <font color="#990000">/</font><font color="#990000">(</font><b><font color="#0000FF">const</font></b> Vec <font color="#990000">&amp;</font>a<font color="#990000">,</font> <font color="#009900">double</font> c<font color="#990000">)</font>
<font color="#FF0000">{</font>
	<font color="#009900">int</font> n <font color="#990000">=</font> a<font color="#990000">.</font><b><font color="#000000">length</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">;</font>
	Vec <b><font color="#000000">vout</font></b><font color="#990000">(</font>n<font color="#990000">)</font><font color="#990000">;</font>
	<b><font color="#0000FF">for</font></b> <font color="#990000">(</font><font color="#009900">int</font> i<font color="#990000">=</font><font color="#993399">0</font><font color="#990000">;</font> i<font color="#990000">&lt;</font>n<font color="#990000">;</font> i<font color="#990000">+</font><font color="#990000">+</font><font color="#990000">)</font> vout<font color="#990000">[</font>i<font color="#990000">]</font> <font color="#990000">=</font> a<font color="#990000">[</font>i<font color="#990000">]</font><font color="#990000">/</font>c<font color="#990000">;</font>
	<b><font color="#0000FF">return</font></b> vout<font color="#990000">;</font>
<font color="#FF0000">}</font>

<font color="#009900">double</font> <font color="#990000">*</font><b><font color="#000000">vector</font></b><font color="#990000">(</font><font color="#009900">int</font> n<font color="#990000">)</font>
<font color="#FF0000">{</font>
	<font color="#009900">double</font> <font color="#990000">*</font>v<font color="#990000">;</font>
	v <font color="#990000">=</font> <b><font color="#0000FF">new</font></b> <font color="#009900">double</font><font color="#990000">[</font>n<font color="#990000">]</font><font color="#990000">;</font>
	<b><font color="#000000">assert</font></b><font color="#990000">(</font>v<font color="#990000">)</font><font color="#990000">;</font>
	<b><font color="#0000FF">return</font></b> v<font color="#990000">;</font>
<font color="#FF0000">}</font>


<font color="#009900">int</font> <font color="#990000">*</font><b><font color="#000000">ivector</font></b><font color="#990000">(</font><font color="#009900">int</font> n<font color="#990000">)</font>
<font color="#FF0000">{</font>
	<font color="#009900">int</font> <font color="#990000">*</font>iv<font color="#990000">;</font>
	iv <font color="#990000">=</font> <b><font color="#0000FF">new</font></b> <font color="#009900">int</font><font color="#990000">[</font>n<font color="#990000">]</font><font color="#990000">;</font>
	<b><font color="#000000">assert</font></b><font color="#990000">(</font>iv<font color="#990000">)</font><font color="#990000">;</font>
	<b><font color="#0000FF">return</font></b> iv<font color="#990000">;</font>
<font color="#FF0000">}</font>


<font color="#009900">void</font> Matrix<font color="#990000">:</font><font color="#990000">:</font><b><font color="#000000">print</font></b><font color="#990000">(</font><font color="#990000">)</font> <b><font color="#0000FF">const</font></b>
<font color="#FF0000">{</font>
	<font color="#009900">int</font> i<font color="#990000">,</font> j<font color="#990000">;</font>
	<b><font color="#0000FF">const</font></b> <font color="#009900">double</font> tiny <font color="#990000">=</font> <font color="#993399">1e-13</font><font color="#990000">;</font>
	<font color="#009900">double</font> <font color="#990000">*</font>vp<font color="#990000">;</font>
	<font color="#009900">double</font> v<font color="#990000">;</font>
	<b><font color="#0000FF">for</font></b> <font color="#990000">(</font>j<font color="#990000">=</font><font color="#993399">0</font><font color="#990000">;</font> j<font color="#990000">&lt;</font>nrows<font color="#990000">;</font> j<font color="#990000">+</font><font color="#990000">+</font><font color="#990000">)</font> <font color="#FF0000">{</font>
		vp <font color="#990000">=</font> body<font color="#990000">[</font>j<font color="#990000">]</font><font color="#990000">;</font>
		<b><font color="#0000FF">for</font></b> <font color="#990000">(</font>i<font color="#990000">=</font><font color="#993399">0</font><font color="#990000">;</font> i<font color="#990000">&lt;</font>ncols<font color="#990000">;</font> i<font color="#990000">+</font><font color="#990000">+</font><font color="#990000">)</font> <font color="#FF0000">{</font>
			v <font color="#990000">=</font> <font color="#990000">*</font>vp<font color="#990000">+</font><font color="#990000">+</font><font color="#990000">;</font>
			<b><font color="#0000FF">if</font></b> <font color="#990000">(</font><b><font color="#000000">fabs</font></b><font color="#990000">(</font>v<font color="#990000">)</font><font color="#990000">&lt;</font>tiny<font color="#990000">)</font> v <font color="#990000">=</font> <font color="#993399">0.0</font><font color="#990000">;</font>
			
			<b><font color="#000000">printf</font></b><font color="#990000">(</font><font color="#FF0000">"% 10.4g"</font><font color="#990000">,</font> v<font color="#990000">)</font><font color="#990000">;</font>
		<font color="#FF0000">}</font>
		<b><font color="#000000">printf</font></b><font color="#990000">(</font><font color="#FF0000">"\n"</font><font color="#990000">)</font><font color="#990000">;</font>
	<font color="#FF0000">}</font>
<font color="#FF0000">}</font>

<font color="#009900">void</font> Vec<font color="#990000">:</font><font color="#990000">:</font><b><font color="#000000">print</font></b><font color="#990000">(</font><font color="#990000">)</font> <b><font color="#0000FF">const</font></b>
<font color="#FF0000">{</font>
	<font color="#009900">double</font> <font color="#990000">*</font>v <font color="#990000">=</font> body<font color="#990000">;</font>
	<font color="#009900">int</font> size <font color="#990000">=</font> n<font color="#990000">;</font>
	<b><font color="#0000FF">while</font></b> <font color="#990000">(</font>size<font color="#990000">-</font><font color="#990000">-</font><font color="#990000">)</font> <font color="#FF0000">{</font>
		<b><font color="#000000">printf</font></b><font color="#990000">(</font><font color="#FF0000">" %10.4g"</font><font color="#990000">,</font> <font color="#990000">*</font>v<font color="#990000">+</font><font color="#990000">+</font><font color="#990000">)</font><font color="#990000">;</font>
	<font color="#FF0000">}</font>
	<b><font color="#000000">printf</font></b><font color="#990000">(</font><font color="#FF0000">"\n"</font><font color="#990000">)</font><font color="#990000">;</font>
<font color="#FF0000">}</font>

<i><font color="#9A1900">//</font></i><i><font color="#9A1900">! copy one Matrix to another</font></i>
<i><font color="#9A1900">/*</font></i><i><font color="#9A1900">!</font></i>
<i><font color="#9A1900"> * @param dst destination Matrix</font></i>
<i><font color="#9A1900"> * @param src source Matrix</font></i>
<i><font color="#9A1900"> * if destination is smaller than the source, the source is truncated.\n</font></i>
<i><font color="#9A1900"> * if destination is larger than the source, the remainder is</font></i>
<i><font color="#9A1900"> * zero-filled\n</font></i>
<i><font color="#9A1900"> </font></i><i><font color="#9A1900">*/</font></i>

<font color="#009900">void</font> <b><font color="#000000">copy_matrix</font></b><font color="#990000">(</font>Matrix <font color="#990000">&amp;</font>dst<font color="#990000">,</font> Matrix <font color="#990000">&amp;</font>src<font color="#990000">)</font>
<font color="#FF0000">{</font>
	<font color="#009900">int</font> i<font color="#990000">,</font> j<font color="#990000">;</font>
	<font color="#009900">int</font> nrows<font color="#990000">,</font> ncols<font color="#990000">;</font>
	<font color="#009900">double</font> <font color="#990000">*</font>s<font color="#990000">,</font> <font color="#990000">*</font>t<font color="#990000">;</font><font color="#990000">;</font>
	nrows <font color="#990000">=</font> <font color="#990000">(</font>dst<font color="#990000">.</font><b><font color="#000000">rows</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">&lt;</font>src<font color="#990000">.</font><b><font color="#000000">rows</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">?</font> dst<font color="#990000">.</font><b><font color="#000000">rows</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">:</font> src<font color="#990000">.</font><b><font color="#000000">rows</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">)</font><font color="#990000">;</font>
	ncols <font color="#990000">=</font> <font color="#990000">(</font>dst<font color="#990000">.</font><b><font color="#000000">cols</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">&lt;</font>src<font color="#990000">.</font><b><font color="#000000">cols</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">?</font> dst<font color="#990000">.</font><b><font color="#000000">cols</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">:</font> src<font color="#990000">.</font><b><font color="#000000">cols</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">)</font><font color="#990000">;</font>
	<b><font color="#0000FF">for</font></b> <font color="#990000">(</font>j<font color="#990000">=</font><font color="#993399">0</font><font color="#990000">;</font> j<font color="#990000">&lt;</font>nrows<font color="#990000">;</font> j<font color="#990000">+</font><font color="#990000">+</font><font color="#990000">)</font> <font color="#FF0000">{</font>
		s <font color="#990000">=</font> src<font color="#990000">[</font>j<font color="#990000">]</font><font color="#990000">;</font>
		t <font color="#990000">=</font> dst<font color="#990000">[</font>j<font color="#990000">]</font><font color="#990000">;</font>
		<b><font color="#0000FF">for</font></b> <font color="#990000">(</font>i<font color="#990000">=</font><font color="#993399">0</font><font color="#990000">;</font> i<font color="#990000">&lt;</font>ncols<font color="#990000">;</font> i<font color="#990000">+</font><font color="#990000">+</font><font color="#990000">)</font> <font color="#990000">*</font>t<font color="#990000">+</font><font color="#990000">+</font> <font color="#990000">=</font> <font color="#990000">*</font>s<font color="#990000">+</font><font color="#990000">+</font><font color="#990000">;</font>
	<font color="#FF0000">}</font>
	<i><font color="#9A1900">//</font></i><i><font color="#9A1900"> Append zero-filled rows to destination</font></i>
	<b><font color="#0000FF">for</font></b> <font color="#990000">(</font>j<font color="#990000">=</font>src<font color="#990000">.</font><b><font color="#000000">rows</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">;</font> j<font color="#990000">&lt;</font>nrows<font color="#990000">;</font> j<font color="#990000">+</font><font color="#990000">+</font><font color="#990000">)</font> <font color="#FF0000">{</font>
		t <font color="#990000">=</font> dst<font color="#990000">[</font>j<font color="#990000">]</font><font color="#990000">;</font>
		<b><font color="#0000FF">for</font></b> <font color="#990000">(</font>i<font color="#990000">=</font><font color="#993399">0</font><font color="#990000">;</font> i<font color="#990000">&lt;</font>ncols<font color="#990000">;</font> i<font color="#990000">+</font><font color="#990000">+</font><font color="#990000">)</font> t<font color="#990000">[</font>i<font color="#990000">]</font> <font color="#990000">=</font> <font color="#993399">0.0</font><font color="#990000">;</font>
	<font color="#FF0000">}</font>
	<i><font color="#9A1900">//</font></i><i><font color="#9A1900"> Append zero-filled columns to destination</font></i>
	<b><font color="#0000FF">if</font></b> <font color="#990000">(</font>src<font color="#990000">.</font><b><font color="#000000">cols</font></b><font color="#990000">(</font><font color="#990000">)</font> <font color="#990000">&lt;</font> ncols<font color="#990000">)</font> <font color="#FF0000">{</font>
		<b><font color="#0000FF">for</font></b> <font color="#990000">(</font>j<font color="#990000">=</font><font color="#993399">0</font><font color="#990000">;</font> j<font color="#990000">&lt;</font>dst<font color="#990000">.</font><b><font color="#000000">rows</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">;</font> j<font color="#990000">+</font><font color="#990000">+</font><font color="#990000">)</font> <font color="#FF0000">{</font>
			t <font color="#990000">=</font> dst<font color="#990000">[</font>j<font color="#990000">]</font><font color="#990000">;</font>
			<b><font color="#0000FF">for</font></b> <font color="#990000">(</font>i<font color="#990000">=</font>src<font color="#990000">.</font><b><font color="#000000">cols</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">;</font> i<font color="#990000">&lt;</font>ncols<font color="#990000">;</font> i<font color="#990000">+</font><font color="#990000">+</font><font color="#990000">)</font> t<font color="#990000">[</font>i<font color="#990000">]</font> <font color="#990000">=</font> <font color="#993399">0.0</font><font color="#990000">;</font>
		<font color="#FF0000">}</font>
	<font color="#FF0000">}</font>
<font color="#FF0000">}</font>

<i><font color="#9A1900">//</font></i><i><font color="#9A1900"> overloaded insertion operator &lt;&lt;</font></i>
std<font color="#990000">:</font><font color="#990000">:</font>ostream<font color="#990000">&amp;</font> <b><font color="#0000FF">operator</font></b> <font color="#990000">&lt;</font><font color="#990000">&lt;</font> <font color="#990000">(</font>std<font color="#990000">:</font><font color="#990000">:</font>ostream<font color="#990000">&amp;</font> s<font color="#990000">,</font> <b><font color="#0000FF">const</font></b> Vec<font color="#990000">&amp;</font> v<font color="#990000">)</font>
<font color="#FF0000">{</font>
	<font color="#009900">char</font> buf<font color="#990000">[</font><font color="#993399">16</font><font color="#990000">]</font><font color="#990000">;</font>
	<font color="#009900">int</font> n <font color="#990000">=</font> v<font color="#990000">.</font><b><font color="#000000">length</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">;</font>
	<b><font color="#0000FF">if</font></b> <font color="#990000">(</font>n <font color="#990000">&gt;</font> <font color="#993399">0</font><font color="#990000">)</font>
		<font color="#FF0000">{</font>
		<i><font color="#9A1900">//</font></i><i><font color="#9A1900">int old_precision = s.precision() ; // get current precision</font></i>
		s <font color="#990000">&lt;</font><font color="#990000">&lt;</font> <font color="#FF0000">"["</font> <font color="#990000">;</font>
		<b><font color="#0000FF">for</font></b> <font color="#990000">(</font><font color="#009900">int</font> i<font color="#990000">=</font><font color="#993399">0</font><font color="#990000">;</font> i<font color="#990000">&lt;</font>n<font color="#990000">;</font> i<font color="#990000">+</font><font color="#990000">+</font><font color="#990000">)</font>
		<font color="#FF0000">{</font>
			<b><font color="#000000">sprintf_s</font></b><font color="#990000">(</font>buf<font color="#990000">,</font><font color="#993399">15</font><font color="#990000">,</font><font color="#FF0000">"%.4g"</font><font color="#990000">,</font>v<font color="#990000">[</font>i<font color="#990000">]</font><font color="#990000">)</font><font color="#990000">;</font>
			<i><font color="#9A1900">//</font></i><i><font color="#9A1900">s &lt;&lt; setprecision (2)</font></i>
				<i><font color="#9A1900">//</font></i><i><font color="#9A1900">&lt;&lt; setiosflags (ios_base::showpoint|ios_base::fixed)</font></i>
			s <font color="#990000">&lt;</font><font color="#990000">&lt;</font> buf <font color="#990000">;</font>
			i<font color="#990000">!</font><font color="#990000">=</font>n<font color="#990000">-</font><font color="#993399">1</font> <font color="#990000">?</font> s <font color="#990000">&lt;</font><font color="#990000">&lt;</font> <font color="#FF0000">", "</font> <font color="#990000">:</font> s <font color="#990000">&lt;</font><font color="#990000">&lt;</font> <font color="#FF0000">"]"</font> <font color="#990000">;</font>
			<font color="#FF0000">}</font>
      <i><font color="#9A1900">//</font></i><i><font color="#9A1900">s &lt;&lt; endl ;</font></i>
		<i><font color="#9A1900">//</font></i><i><font color="#9A1900"> reset precision and ios flags</font></i>
		<i><font color="#9A1900">//</font></i><i><font color="#9A1900">s.precision (old_precision) ;</font></i>
		<i><font color="#9A1900">//</font></i><i><font color="#9A1900">std::resetiosflags (ios::showpoint|std::ios::fixed) ;</font></i>
		<font color="#FF0000">}</font>
	<b><font color="#0000FF">return</font></b> s <font color="#990000">;</font>
	<font color="#FF0000">}</font>
</tt></pre>
<p><hr>





<h2><code>main.cpp</code></h2>

<p><hr><a name=main.cpp>
<!-- Generator: GNU source-highlight 2.1.2
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><b><font color="#000080">#include</font></b> <font color="#FF0000">&lt;stdio.h&gt;</font>
<b><font color="#000080">#include</font></b> <font color="#FF0000">&lt;stdlib.h&gt;</font>
<b><font color="#000080">#include</font></b> <font color="#FF0000">&lt;math.h&gt;</font>
<b><font color="#000080">#include</font></b> <font color="#FF0000">&lt;iostream&gt;</font>
<b><font color="#000080">#include</font></b> <font color="#FF0000">"matrix.h"</font>
<b><font color="#0000FF">using</font></b> <b><font color="#0000FF">namespace</font></b> std<font color="#990000">;</font>

<i><font color="#9A1900">//</font></i><i><font color="#9A1900">! Tests operation of vector/matrix classes</font></i>

<font color="#009900">int</font> <b><font color="#000000">main</font></b><font color="#990000">(</font><font color="#990000">)</font>
<font color="#FF0000">{</font>
	Matrix <b><font color="#000000">G</font></b><font color="#990000">(</font><font color="#993399">5</font><font color="#990000">,</font><font color="#993399">3</font><font color="#990000">)</font><font color="#990000">;</font>
	Vec <b><font color="#000000">a</font></b><font color="#990000">(</font><font color="#993399">3</font><font color="#990000">)</font><font color="#990000">,</font> <b><font color="#000000">b</font></b><font color="#990000">(</font><font color="#993399">3</font><font color="#990000">)</font><font color="#990000">;</font>
	<font color="#009900">int</font> i<font color="#990000">,</font> j<font color="#990000">;</font>
	<b><font color="#0000FF">for</font></b> <font color="#990000">(</font>i<font color="#990000">=</font><font color="#993399">0</font><font color="#990000">;</font> i<font color="#990000">&lt;</font><font color="#993399">3</font><font color="#990000">;</font> i<font color="#990000">+</font><font color="#990000">+</font><font color="#990000">)</font> <font color="#FF0000">{</font>
		a<font color="#990000">[</font>i<font color="#990000">]</font> <font color="#990000">=</font> i<font color="#990000">+</font><font color="#993399">1</font><font color="#990000">;</font>
		b<font color="#990000">[</font>i<font color="#990000">]</font> <font color="#990000">=</font> i<font color="#990000">-</font><font color="#993399">1</font><font color="#990000">;</font>
	<font color="#FF0000">}</font>
	<b><font color="#000000">printf</font></b><font color="#990000">(</font><font color="#FF0000">"vector a =\n"</font><font color="#990000">)</font><font color="#990000">;</font>
	a<font color="#990000">.</font><b><font color="#000000">print</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">;</font>
	cout <font color="#990000">&lt;</font><font color="#990000">&lt;</font> a <font color="#990000">&lt;</font><font color="#990000">&lt;</font> endl<font color="#990000">;</font>
	<b><font color="#000000">printf</font></b><font color="#990000">(</font><font color="#FF0000">"vector b =\n"</font><font color="#990000">)</font><font color="#990000">;</font>
	b<font color="#990000">.</font><b><font color="#000000">print</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">;</font>
	Vec c <font color="#990000">=</font> a<font color="#990000">+</font>b<font color="#990000">;</font> <i><font color="#9A1900">//</font></i><i><font color="#9A1900">vec::add(a,b);</font></i>
	<b><font color="#000000">printf</font></b><font color="#990000">(</font><font color="#FF0000">"vector a + b =\n"</font><font color="#990000">)</font><font color="#990000">;</font>
	c<font color="#990000">.</font><b><font color="#000000">print</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">;</font>
	c <font color="#990000">=</font> a<font color="#990000">;</font> <i><font color="#9A1900">//</font></i><i><font color="#9A1900"> copy vector to c</font></i>
	a<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#993399">4</font><font color="#990000">;</font>
	<b><font color="#000000">printf</font></b><font color="#990000">(</font><font color="#FF0000">"element by element sqrt:\n"</font><font color="#990000">)</font><font color="#990000">;</font>
	c<font color="#990000">.</font><b><font color="#000000">apply</font></b><font color="#990000">(</font>sqrt<font color="#990000">)</font><font color="#990000">.</font><b><font color="#000000">print</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">;</font>

	<b><font color="#000000">printf</font></b><font color="#990000">(</font><font color="#FF0000">"a dot b = %g\n"</font><font color="#990000">,</font>Vec<font color="#990000">:</font><font color="#990000">:</font><b><font color="#000000">dot</font></b><font color="#990000">(</font>a<font color="#990000">,</font>b<font color="#990000">)</font><font color="#990000">)</font><font color="#990000">;</font>
	
	<b><font color="#0000FF">for</font></b> <font color="#990000">(</font>j<font color="#990000">=</font><font color="#993399">0</font><font color="#990000">;</font> j<font color="#990000">&lt;</font>G<font color="#990000">.</font><b><font color="#000000">cols</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">;</font> j<font color="#990000">+</font><font color="#990000">+</font><font color="#990000">)</font> <font color="#FF0000">{</font>
		<b><font color="#0000FF">for</font></b> <font color="#990000">(</font>i<font color="#990000">=</font><font color="#993399">0</font><font color="#990000">;</font> i<font color="#990000">&lt;</font>G<font color="#990000">.</font><b><font color="#000000">rows</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">;</font> i<font color="#990000">+</font><font color="#990000">+</font><font color="#990000">)</font> G<font color="#990000">[</font>i<font color="#990000">]</font><font color="#990000">[</font>j<font color="#990000">]</font> <font color="#990000">=</font> <font color="#990000">(</font>i<font color="#990000">+</font><font color="#993399">1</font><font color="#990000">)</font><font color="#990000">*</font><font color="#993399">10</font> <font color="#990000">+</font> <font color="#990000">(</font>j<font color="#990000">+</font><font color="#993399">1</font><font color="#990000">)</font><font color="#990000">;</font>
	<font color="#FF0000">}</font>
	<b><font color="#000000">printf</font></b><font color="#990000">(</font><font color="#FF0000">"matrix G =\n"</font><font color="#990000">)</font><font color="#990000">;</font>
	G<font color="#990000">.</font><b><font color="#000000">print</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">;</font>
	Vec d <font color="#990000">=</font> G<font color="#990000">*</font>b<font color="#990000">;</font> <i><font color="#9A1900">//</font></i><i><font color="#9A1900"> Matrix::mul(G,b);</font></i>
	<b><font color="#000000">printf</font></b><font color="#990000">(</font><font color="#FF0000">"G*b = \n"</font><font color="#990000">)</font><font color="#990000">;</font>
	cout <font color="#990000">&lt;</font><font color="#990000">&lt;</font> d <font color="#990000">&lt;</font><font color="#990000">&lt;</font> endl<font color="#990000">;</font>
	<b><font color="#000000">printf</font></b><font color="#990000">(</font><font color="#FF0000">"matrix %d x %d\n"</font><font color="#990000">,</font>G<font color="#990000">.</font><b><font color="#000000">rows</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">,</font>G<font color="#990000">.</font><b><font color="#000000">cols</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">)</font><font color="#990000">;</font>
	Vec <b><font color="#000000">e</font></b><font color="#990000">(</font><font color="#993399">5</font><font color="#990000">)</font><font color="#990000">;</font>
	<b><font color="#0000FF">for</font></b> <font color="#990000">(</font>i<font color="#990000">=</font><font color="#993399">0</font><font color="#990000">;</font> i<font color="#990000">&lt;</font><font color="#993399">5</font><font color="#990000">;</font> i<font color="#990000">+</font><font color="#990000">+</font><font color="#990000">)</font> e<font color="#990000">[</font>i<font color="#990000">]</font><font color="#990000">=</font>i<font color="#990000">-</font><font color="#993399">2</font><font color="#990000">;</font>
	<b><font color="#000000">printf</font></b><font color="#990000">(</font><font color="#FF0000">"vector e = \n"</font><font color="#990000">)</font><font color="#990000">;</font>
	cout <font color="#990000">&lt;</font><font color="#990000">&lt;</font> e <font color="#990000">&lt;</font><font color="#990000">&lt;</font> endl<font color="#990000">;</font>
	Vec f <font color="#990000">=</font> e<font color="#990000">*</font>G<font color="#990000">;</font> <i><font color="#9A1900">//</font></i><i><font color="#9A1900">Matrix::mul(e,G);</font></i>
	<b><font color="#000000">printf</font></b><font color="#990000">(</font><font color="#FF0000">"e*G =\n"</font><font color="#990000">)</font><font color="#990000">;</font>
	cout <font color="#990000">&lt;</font><font color="#990000">&lt;</font> f <font color="#990000">&lt;</font><font color="#990000">&lt;</font> endl<font color="#990000">;</font>
	<b><font color="#0000FF">return</font></b> EXIT_SUCCESS<font color="#990000">;</font>
<font color="#FF0000">}</font></tt></pre>
<p><hr>

<h3>Results</h3>



<pre>
C:\classes\ece538\Matrix1\Matrix>main
vector a =
          1          2          3
[1, 2, 3]
vector b =
         -1          0          1
vector a + b =
          0          2          4
element by element sqrt:
          1      1.414      1.732
a dot b = -1
matrix G =
        11        12        13
        21        22        23
        31        32        33
        41        42        43
        51        52        53
G*b =
[2, 2, 2, 2, 2]
matrix 5 x 3
vector e =
[-2, -1, 0, 1, 2]
e*G =
[100, 100, 100]
</pre>

<p><hr>

<p>Maintained by <a href=http://www.johnloomis.org>John Loomis</a>,
updated <i>Wed Feb 07 22:46:23 2007</i>

</body></html>
